<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dud Football</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f8fbfd; --text:#111; --link:#0366d6; --card:#fff; --muted:#6b7280;
      --accent:#0ea5e9; --ok:#16a34a; --chip:#eef2ff; --chipText:#1e293b;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;background:#ffffffcc;backdrop-filter:blur(6px);border-bottom:1px solid #e5e7eb}
    .wrap{max-width:980px;margin:0 auto;padding:18px}
    nav a{margin-right:1rem;color:var(--link);text-decoration:none}
    h1{margin:.2rem 0 0}
    h2{margin:1.2rem 0 .6rem}
    .card{background:var(--card);border:1px solid #e5e7eb;border-radius:12px;padding:16px}
    .note{color:var(--muted);font-size:.95rem}

    .featured{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    .featured .slot{
      aspect-ratio:16/9;border:1px dashed #cbd5e1;border-radius:10px;
      display:flex;align-items:center;justify-content:center;color:#94a3b8;background:#fff;
    }
    .featured img{width:100%;height:100%;object-fit:cover;border-radius:10px}

    form.compact{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    form.compact .full{grid-column:1 / -1}
    label{font-weight:600;font-size:.95rem}
    input,select{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:8px;margin-top:.25rem}
    button{padding:.6rem 1rem;border:0;border-radius:999px;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
    #form-status{margin-left:.6rem;color:var(--muted)}

    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{padding:.45rem .7rem;border-radius:999px;background:#eef2ff;color:#1e293b;border:1px solid #c7d2fe;font-weight:600;font-size:.9rem}
    .chip.submitted{background:#ecfdf5;border-color:#86efac;color:#166534}
    .chip.submitted::after{content:" ✓";color:var(--ok);font-weight:900}

    #standings-wrap{display:none}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.55rem;border-bottom:1px solid #e5e7eb;text-align:left}
    th{color:#374151}
    .controls{display:flex;gap:10px;align-items:center;margin:.5rem 0}
    @media (max-width:700px){.featured{grid-template-columns:1fr 1fr} form.compact{grid-template-columns:1fr}}
  </style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;align-items:center;justify-content:space-between;gap:16px">
    <div>
      <h1>Dud Football</h1>
      <div class="note">Pick one QB, RB, WR, TE, K. Lowest total wins.</div>
    </div>
    <nav>
      <a href="#home">Home</a>
      <a href="#week1">Week 1</a>
      <a href="#about">About</a>
    </nav>
  </div>
</header>

<main class="wrap" id="home" style="padding-top:16px">
  <section class="card">
    <h2>Featured Games</h2>
    <div class="featured" id="featured">
  <img src="tnf_cow_eag.jpg" alt="TNF: Cowboys @ Eagles">
  <div class="slot">  <img src="fnf_ke_lac.jpg" alt="FNF: Chiefs @ Chargers">
</div>
  <div class="slot">  <img src="sfb_gb_det.jpg" alt="SDF: Lions @ Packers">
</div>
  <div class="slot">  <img src="mnf_chi_min.jpg" alt="MNF: Vikings @ Bears">
</div>
</div>
  </section>

  <section style="margin-top:18px">
    <h2>Submit your picks</h2>
    <div class="card">
      <form id="dud-form" class="compact">
        <div class="full">
          <label>Name
            <input type="text" name="name" id="name-input" list="roster-list" autocomplete="off" required />
            <datalist id="roster-list"></datalist>
          </label>
        </div>

        <label>QB <select name="qb" id="sel-qb"></select></label>
        <label>RB <select name="rb" id="sel-rb"></select></label>
        <label>WR <select name="wr" id="sel-wr"></select></label>
        <label>TE <select name="te" id="sel-te"></select></label>
        <div class="full">
          <label>K <select name="k" id="sel-k"></select></label>
        </div>

        <div class="full controls">
          <button type="submit">Submit picks</button>
          <span id="form-status" class="note"></span>
        </div>
      </form>
    </div>
  </section>

  <section id="week1" style="margin-top:18px">
    <h2>Player check-in</h2>
    <div class="card">
      <div class="note">Green = submitted this week</div>
      <div id="chips" class="chips"></div>
    </div>
  </section>

  <section style="margin-top:18px">
    <div class="controls">
      <button id="toggle-standings" type="button">Show standings</button>
      <span class="note">Table is hidden until you choose to reveal it.</span>
    </div>
    <div id="standings-wrap" class="card" style="overflow:auto">
      <table id="standings">
        <thead><tr>
          <th>#</th><th>Name</th><th>Total</th><th>QB</th><th>RB</th><th>WR</th><th>TE</th><th>K</th>
        </tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <section id="about" style="margin:18px 0 36px">
    <h2>About</h2>
    <div class="card">
      Started in 2005-ish: the opposite of normal fantasy—lowest score wins!
      We add +15 if your player posts no stats, so you can’t “no-play”.
    </div>
  </section>
</main>

<script>
  /* === CONFIG === */
  const SCRIPT_URL    = 'https://script.google.com/macros/s/AKfycbyHqOhNudJmmHKuxNlt7kp4Bl5NuZlRvNn_COO97N6kFHjxKa212LlIxQYzaSME2GVk/exec';
  const STANDINGS_URL = SCRIPT_URL + '?view=standings';

  // If you publish your sheet (File → Share → Publish to web → CSV), paste that link here for CORS-free reads:
  const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSldDkrQHAfBel9ImfzVJ9ZxYV9I9yNikKrRAjChBmktW7nU6BZchcVMsntpeh3rAztzi0-1QKR5QqQ/pub?gid=0&single=true&output=csv'

  // === Your league roster (used for chips + name autocomplete) ===
  const ROSTER = [
    'David Cook',
    'Al Kremer','Adam McCloud','Chad Neff','Chris Gotsch','Dan Adams','Devin Hester',
    'Doug Blatti','Eric Changler','Jason Muench','Jeremy Palese','Jim Altendorf',
    'Mark Anderson','Matt Rogers','Michael Arrigoni','Matt Richards',
    'Ryan Brunswick','Ryan Slattery','Tim Garis','Will Peterson'
  ];

  // ---------- load players.json ----------
  let LOADED_LISTS = null;
  let CURRENT_WEEK = null;

  async function loadPlayersJson(){
    try{
      const qp = new URLSearchParams(location.search);
      const weekOverride = qp.get('week');

      const res = await fetch('players.json?v=' + Date.now(), {cache:'no-store'});
      const data = await res.json();

      CURRENT_WEEK = weekOverride || data.currentWeek || null;

      let pos = data.positions || {};
      if (data.weeks && CURRENT_WEEK && data.weeks[String(CURRENT_WEEK)]?.positions){
        pos = data.weeks[String(CURRENT_WEEK)].positions;
      }

      const withPlaceholder = (arr, label)=> ['— Select ' + label + ' —', ...(arr || [])];







